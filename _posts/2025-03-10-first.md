---
layout: post
title:  "Welcome to Jekyll!"
---

# 오늘 처음 블로그를 만들었어요
앞으로 열심히 해보겠습니다

```{r}
# 세 자리 수 만들기
make_number <- function(h, t, o) {
  100 * h + 10 * t + o
}

simulate_game_fixed <- function(d1, d2, d3) {
  # d1의 고정 배치: 1-2 → 1의자리, 3-4 → 10의자리, 5-6 → 100의자리
  if (d1 <= 2) {
    pos_d1 <- 3  # 일의 자리
  } else if (d1 <= 4) {
    pos_d1 <- 2  # 십의 자리
  } else {
    pos_d1 <- 1  # 백의 자리
  }
  
  # 빈 자리 설정 및 d1 배치
  slots <- rep(NA, 3)
  slots[pos_d1] <- d1
  remaining <- setdiff(1:3, pos_d1)
  
  # 남은 자리 중 d2 배치 결정:
  # d3 값(1:6)에 따른 최종 수의 평균이 가장 높은 자리를 선택
  best_exp <- -Inf
  best_d2_pos <- NA
  for (pos in remaining) {
    temp <- slots
    temp[pos] <- d2
    other <- setdiff(remaining, pos)
    exp_val <- mean(sapply(1:6, function(x) {
      temp[other] <- x
      make_number(temp[1], temp[2], temp[3])
    }))
    if (exp_val > best_exp) {
      best_exp <- exp_val
      best_d2_pos <- pos
    }
  }
  slots[best_d2_pos] <- d2
  
  # 남은 한 자리에 d3 배치
  last_pos <- setdiff(1:3, c(pos_d1, best_d2_pos))
  slots[last_pos] <- d3
  
  make_number(slots[1], slots[2], slots[3])
}


games <- read.csv("three_dice.csv")

# 각 게임의 최종 점수 
games$score <- mapply(simulate_game_fixed, games$dice1, games$dice2, games$dice3)

sum(games$score)
mean(games$score)


# 그래프
score_table <- table(games$score)
barplot(score_table, main = "최적 전략 사용 시 세 자리 수 분포",
        xlab = "점수", ylab = "빈도",
        col = "skyblue", border = "blue")

# 모든 216가지 경우에 대한 이론적 기댓값 
outcomes <- expand.grid(dice1 = 1:6, dice2 = 1:6, dice3 = 1:6)
all_scores <- mapply(simulate_game_fixed, outcomes$dice1, outcomes$dice2, outcomes$dice3)
theoretical_expectation <- mean(all_scores)
theoretical_expectation
```
